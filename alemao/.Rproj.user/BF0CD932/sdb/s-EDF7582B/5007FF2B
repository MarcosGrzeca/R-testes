{
    "collab_server" : "",
    "contents" : "#Carregar bibliotecas\nlibrary(arules)\noptions(max.print = 99999999)\n\n#Carrega functions\nDIRETORIO = \"C:\\\\Users\\\\Marcos\\\\Documents\\\\GitHub\\\\R-testes\\\\\"\nsource(file=paste(DIRETORIO,\"functions.R\", sep = \"\"))\nsource(file=paste(DIRETORIO,\"visualizacao.R\", sep = \"\"))\nsource(file=paste(DIRETORIO,\"preditiva.R\", sep = \"\"))\n\n\n#Configura??es\nDATABASE <- \"enem\"\nclearConsole();\n#dadosBrutos <- query(\"SELECT NO_MUNICIPIO_RESIDENCIA, COD_ESCOLA, COD_MUNICIPIO_ESC, ID_LOCALIZACAO_ESC, SIT_FUNC_ESC, TP_SEXO, NACIONALIDADE, NO_MUNICIPIO_NASCIMENTO, UF_NASCIMENTO, ST_CONCLUSAO, ANO_CONCLUIU, IN_TP_ENSINO, TP_ESTADO_CIVIL, TP_COR_RACA, IN_CERTIFICADO, NO_MUNICIPIO_PROVA, ID_PROVA_CN, ID_PROVA_CH, ID_PROVA_LC, ID_PROVA_MT, TP_LINGUA, Q001, Q002, Q004, Q005, Q006, Q007, Q008, Q009, Q010, Q011, Q012, Q013, Q014, Q015, Q016, Q017, Q018, Q019, Q020, Q021, Q022, Q023, Q024, Q025, Q026, Q027, Q028, Q029, Q030, Q031, Q032, Q033, Q034, Q035, Q036, Q037, Q038, Q039, Q040, Q041, Q042, Q043, Q044, Q045, Q046, Q047, Q048, Q049, Q050, Q051, Q052, Q053, Q054, Q055, Q056, Q057, Q058, Q059, Q060, Q061, Q062, Q063, Q064, Q065, Q066, Q067, Q068, Q069, Q070, Q071, Q072, Q073, Q074, Q075, Q076, classeIBGE, totalCursos, faixaEtaria, necess_especiais, ate_necess_especiais, tipoEscola, media FROM enem\")\n#dadosBrutos <- query(\"SELECT ID_LOCALIZACAO_ESC, SIT_FUNC_ESC, TP_SEXO, NACIONALIDADE, ST_CONCLUSAO, ANO_CONCLUIU, IN_TP_ENSINO, TP_ESTADO_CIVIL, TP_COR_RACA, IN_CERTIFICADO, ID_PROVA_CN, ID_PROVA_CH, ID_PROVA_LC, ID_PROVA_MT, TP_LINGUA, Q001, Q002, Q004, Q005, Q006, Q007, Q008, Q009, Q010, Q011, Q012, Q013, Q014, Q015, Q016, Q017, Q018, Q019, Q020, Q021, Q022, Q023, Q024, Q025, Q026, Q027, Q028, Q029, Q030, Q031, Q032, Q033, Q034, Q035, Q036, Q037, Q038, Q039, Q040, Q041, Q042, Q043, Q044, Q045, Q046, Q047, Q048, Q049, Q050, Q051, Q052, Q053, Q054, Q055, Q056, Q057, Q058, Q059, Q060, Q061, Q062, Q063, Q064, Q065, Q066, Q067, Q068, Q069, Q070, Q071, Q072, Q073, Q074, Q075, Q076, classeIBGE, totalCursos, faixaEtaria, necess_especiais, ate_necess_especiais, tipoEscola, media FROM enem\")\n\n#Campos 200 primeiras regras Apriori C\ndadosBrutos <- query(\"SELECT ANO_CONCLUIU, Q010, Q015, Q017, classeIBGE, Q021, totalCursos, Q014, Q018, Q019, Q005, Q007, faixaEtaria, Q024, Q028, Q029, Q011, Q012, Q008, Q023, media FROM enem\")\n\n#campos 200 primeiras regras Apriori A\ndadosBrutos <- query(\"SELECT IN_TP_ENSINO, Q006, Q030, Q033, tipoEscola, NACIONALIDADE, TP_ESTADO_CIVIL, Q026, Q038, Q016, Q012, Q017, Q040, Q022, Q013, media FROM enem\")\n\nstr(dadosBrutos)\n\ndadosBrutos$IN_TP_ENSINO[dadosBrutos$IN_TP_ENSINO == \"\"] <- NA\ndadosBrutos$ANO_CONCLUIU[dadosBrutos$ANO_CONCLUIU == \"\"] <- \"2014\"\ndadosBrutos$IN_CERTIFICADO[dadosBrutos$IN_CERTIFICADO == \"\"] <- NA\ndadosBrutos$COD_ESCOLA[dadosBrutos$COD_ESCOLA == \"\"] <- NA\ndadosBrutos$COD_MUNICIPIO_ESC[dadosBrutos$COD_MUNICIPIO_ESC == \"\"] <- NA\ndadosBrutos$ID_LOCALIZACAO_ESC[dadosBrutos$ID_LOCALIZACAO_ESC == \"\"] <- NA\ndadosBrutos$SIT_FUNC_ESC[dadosBrutos$SIT_FUNC_ESC == \"\"] <- NA\ndadosBrutos$Q025[dadosBrutos$Q025 == \"\"] <- NA\ndadosBrutos$Q031[dadosBrutos$Q031 == \"\"] <- NA\ndadosBrutos$Q032[dadosBrutos$Q032 == \"\"] <- NA\ndadosBrutos$Q034[dadosBrutos$Q034 == \"\"] <- NA\ndadosBrutos$Q035[dadosBrutos$Q035 == \"\"] <- NA\ndadosBrutos$Q041[dadosBrutos$Q041 == \"\"] <- NA\ndadosBrutos$Q042[dadosBrutos$Q042 == \"\"] <- NA\ndadosBrutos$Q043[dadosBrutos$Q043 == \"\"] <- NA\ndadosBrutos$Q044[dadosBrutos$Q044 == \"\"] <- NA\ndadosBrutos$Q045[dadosBrutos$Q045 == \"\"] <- NA\ndadosBrutos$Q046[dadosBrutos$Q046 == \"\"] <- NA\ndadosBrutos$Q047[dadosBrutos$Q047 == \"\"] <- NA\ndadosBrutos$Q048[dadosBrutos$Q048 == \"\"] <- NA\ndadosBrutos$Q049[dadosBrutos$Q049 == \"\"] <- NA\ndadosBrutos$Q050[dadosBrutos$Q050 == \"\"] <- NA\ndadosBrutos$Q051[dadosBrutos$Q051 == \"\"] <- NA\ndadosBrutos$Q052[dadosBrutos$Q052 == \"\"] <- NA\ndadosBrutos$Q053[dadosBrutos$Q053 == \"\"] <- NA\ndadosBrutos$Q054[dadosBrutos$Q054 == \"\"] <- NA\ndadosBrutos$Q055[dadosBrutos$Q055 == \"\"] <- NA\ndadosBrutos$Q056[dadosBrutos$Q056 == \"\"] <- NA\ndadosBrutos$Q057[dadosBrutos$Q057 == \"\"] <- NA\ndadosBrutos$Q058[dadosBrutos$Q058 == \"\"] <- NA\ndadosBrutos$Q059[dadosBrutos$Q059 == \"\"] <- NA\ndadosBrutos$Q060[dadosBrutos$Q060 == \"\"] <- NA\ndadosBrutos$Q061[dadosBrutos$Q061 == \"\"] <- NA\ndadosBrutos$Q062[dadosBrutos$Q062 == \"\"] <- NA\ndadosBrutos$Q063[dadosBrutos$Q063 == \"\"] <- NA\ndadosBrutos$Q064[dadosBrutos$Q064 == \"\"] <- NA\ndadosBrutos$Q065[dadosBrutos$Q065 == \"\"] <- NA\ndadosBrutos$Q066[dadosBrutos$Q066 == \"\"] <- NA\ndadosBrutos$Q067[dadosBrutos$Q067 == \"\"] <- NA\ndadosBrutos$Q068[dadosBrutos$Q068 == \"\"] <- NA\ndadosBrutos$Q069[dadosBrutos$Q069 == \"\"] <- NA\ndadosBrutos$Q070[dadosBrutos$Q070 == \"\"] <- NA\ndadosBrutos$Q071[dadosBrutos$Q071 == \"\"] <- NA\ndadosBrutos$Q072[dadosBrutos$Q072 == \"\"] <- NA\ndadosBrutos$Q073[dadosBrutos$Q073 == \"\"] <- NA\ndadosBrutos$Q074[dadosBrutos$Q074 == \"\"] <- NA\ndadosBrutos$Q075[dadosBrutos$Q075 == \"\"] <- NA\ndadosBrutos$Q076[dadosBrutos$Q076 == \"\"] <- NA\ndadosBrutos$Q076[dadosBrutos$Q076 == \"\\r\"] <- NA\ndadosBrutos$tipoEscola[dadosBrutos$tipoEscola == \"\"] <- NA\ndadosBrutos$TP_LINGUA[dadosBrutos$TP_LINGUA == 0] <- \"I\"\ndadosBrutos$TP_LINGUA[dadosBrutos$TP_LINGUA == 1] <- \"E\"\n\ndadosBrutos$NACIONALIDADE[dadosBrutos$NACIONALIDADE == 1] <- \"B\"\ndadosBrutos$NACIONALIDADE[dadosBrutos$NACIONALIDADE == 2] <- \"BN\"\ndadosBrutos$NACIONALIDADE[dadosBrutos$NACIONALIDADE == 3] <- \"E\"\ndadosBrutos$NACIONALIDADE[dadosBrutos$NACIONALIDADE == 4] <- \"BNE\"\ndadosBrutos$necess_especiais[dadosBrutos$necess_especiais == 1] <- \"S\"\ndadosBrutos$necess_especiais[dadosBrutos$necess_especiais == 0] <- \"N\"\ndadosBrutos$ate_necess_especiais[dadosBrutos$ate_necess_especiais == 0] <- \"N\"\ndadosBrutos$ate_necess_especiais[dadosBrutos$ate_necess_especiais == 1] <- \"S\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 0] <- \"ND\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 1] <- \"BR\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 2] <- \"PR\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 3] <- \"PA\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 4] <- \"AM\"\ndadosBrutos$TP_COR_RACA[dadosBrutos$TP_COR_RACA == 5] <- \"IN\"\ndadosBrutos$TP_ESTADO_CIVIL[dadosBrutos$TP_ESTADO_CIVIL == 0] <- \"Sol\"\ndadosBrutos$TP_ESTADO_CIVIL[dadosBrutos$TP_ESTADO_CIVIL == 1] <- \"Cas\"\ndadosBrutos$TP_ESTADO_CIVIL[dadosBrutos$TP_ESTADO_CIVIL == 2] <- \"Div\"\ndadosBrutos$TP_ESTADO_CIVIL[dadosBrutos$TP_ESTADO_CIVIL == 3] <- \"Viu\"\ndadosBrutos$ID_PROVA_CN[dadosBrutos$ID_PROVA_CN == 199] <- \"AZUL\"\ndadosBrutos$ID_PROVA_CN[dadosBrutos$ID_PROVA_CN == 200] <- \"AMARELO\"\ndadosBrutos$ID_PROVA_CN[dadosBrutos$ID_PROVA_CN == 201] <- \"BRANCO\"\ndadosBrutos$ID_PROVA_CN[dadosBrutos$ID_PROVA_CN == 202] <- \"ROSA\"\ndadosBrutos$ID_PROVA_CN[dadosBrutos$ID_PROVA_CN == 216] <- \"BRANCO - ADAP\"\ndadosBrutos$ID_PROVA_CH[dadosBrutos$ID_PROVA_CH == 195] <- \"AZUL\"\ndadosBrutos$ID_PROVA_CH[dadosBrutos$ID_PROVA_CH == 196] <- \"AMARELO\"\ndadosBrutos$ID_PROVA_CH[dadosBrutos$ID_PROVA_CH == 197] <- \"BRANCO\"\ndadosBrutos$ID_PROVA_CH[dadosBrutos$ID_PROVA_CH == 198] <- \"ROSA\"\ndadosBrutos$ID_PROVA_CH[dadosBrutos$ID_PROVA_CH == 215] <- \"BRANCO - ADAP\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 203] <- \"AMARELO\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 204] <- \"CINZA\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 205] <- \"AZUL\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 206] <- \"ROSA\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 213] <- \"CINZA - Reaplicacao\"\ndadosBrutos$ID_PROVA_LC[dadosBrutos$ID_PROVA_LC == 217] <- \"CINZA - ADAP\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 207] <- \"AMARELO\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 208] <- \"CINZA\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 209] <- \"AZUL\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 210] <- \"ROSA\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 214] <- \"CINZA - Reaplicacao\"\ndadosBrutos$ID_PROVA_MT[dadosBrutos$ID_PROVA_MT == 218] <- \"CINZA - ADAP\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 1] <- \"1\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 2] <- \"2\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 3] <- \"3\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 4] <- \"4\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 5] <- \"5\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 6] <- \"6\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 7] <- \"7\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 8] <- \"8\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 9] <- \"9\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 10] <- \"10\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 11] <- \"11\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 12] <- \"12\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 13] <- \"13\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 14] <- \"14\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 15] <- \"15\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 16] <- \"16\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 17] <- \"17\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 18] <- \"18\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 19] <- \"19\"\ndadosBrutos$Q004[dadosBrutos$Q004 == 20] <- \"20+\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 13] <- \"< 14\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 14] <- \"14\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 15] <- \"15\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 16] <- \"16\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 17] <- \"17\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 18] <- \"18\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 19] <- \"19\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 20] <- \"20\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 21] <- \"21\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 22] <- \"22\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 23] <- \"23\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 24] <- \"24\"\ndadosBrutos$Q040[dadosBrutos$Q040 == 25] <- \"25+\"\n\ndadosBrutos$ST_CONCLUSAO[dadosBrutos$ST_CONCLUSAO == 1] <- \"A\"\ndadosBrutos$ST_CONCLUSAO[dadosBrutos$ST_CONCLUSAO == 2] <- \"B\"\ndadosBrutos$ST_CONCLUSAO[dadosBrutos$ST_CONCLUSAO == 3] <- \"C\"\ndadosBrutos$ST_CONCLUSAO[dadosBrutos$ST_CONCLUSAO == 4] <- \"D\"\n\n#Converter apenas um campo para fator\n#dadosBrutos$ST_CONCLUSAO <- as.factor(dadosBrutos$ST_CONCLUSAO)\n\n#Convertaer para fator todos campos\ndados <- as.data.frame(unclass(dadosBrutos))\nstr(dados)\n\n\nclearConsole();\n\n#Execu??o apriori\n#rules <- apriori(dados, parameter = list(minlen=2, supp=0.8, conf=0.7), appearance = list(rhs=c(\"TP_ESCOLA=1\", \"TP_ESCOLA=2\"), default=\"lhs\"), control = list(verbose=F))\n\n#rules <- apriori(dados, parameter = list(minlen=2, supp=0.1, conf=0.5, maxtime =80), appearance = list(rhs=c(\"tipoEscola=PR\"), default=\"lhs\"), control = list(verbose=F))\n\n#Apriori todas medias\n#rules <- apriori(dados, parameter = list(minlen=2, supp=0.35, conf=0.5, maxtime =100), appearance = list(rhs=c(\"media=A\", \"media=B\", \"media=C\"), default=\"lhs\"), control = list(verbose=F))\n\nrules <- apriori(dados, parameter = list(minlen=2, maxlen=20, supp=0.04, conf=0.41, maxtime = 15000), appearance = list(rhs=c(\"media=C\"), default=\"lhs\"), control = list(verbose=F))\nrules <- apriori(dados, parameter = list(minlen=2, maxlen=20, supp=0.05, conf=0.60, maxtime = 15000), appearance = list(rhs=c(\"media=A\"), default=\"lhs\"), control = list(verbose=F))\nrules44 <- apriori(dados, parameter = list(minlen=2, maxlen=20, supp=0.05, conf=0.60, maxtime = 10), appearance = list(rhs=c(\"media=A\"), default=\"lhs\"), control = list(verbose=F))\n\n\n#Reordenar regras\nrules.sorted <- sort(rules, by=\"lift\")\n#inspect(rules)\n\n# find redundant rules\nsubset.matrix <- is.subset(rules.sorted, rules.sorted)\nsubset.matrix[lower.tri(subset.matrix, diag=T)] <- NA\nredundant <- colSums(subset.matrix, na.rm=T) >= 1\nwhich(redundant)\n# remove redundant rules\nrules.pruned <- rules.sorted[!redundant]\nclearConsole();\n\nprint(\"Resultado Final\")\ninitFileLog(\"result200_A.txt\")\ninspect(rules.pruned)\nfinishFileLog(\"result200_A.txt\")\n\nclearConsole()\nregrasA <- rules.pruned\ninspect(regrasA)\n",
    "created" : 1497827664973.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3354975833",
    "id" : "5007FF2B",
    "lastKnownWriteTime" : 1480206749,
    "last_content_update" : 1480206749,
    "path" : "~/GitHub/R-testes/consumidor.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}